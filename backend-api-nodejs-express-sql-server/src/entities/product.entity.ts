import {
  Column,
  Entity,
  ManyToOne,
  OneToMany,
  PrimaryGeneratedColumn,
  CreateDateColumn,
  UpdateDateColumn,
  JoinColumn,
} from 'typeorm';
import { Category } from '../entities/category.entity';
import { Brand } from '../entities/brand.entity';
import { ProductImage } from '../entities/product-image.entity';

@Entity({ name: 'products' })
export class Product {
  // ----------------------------------------------------------------------------------------------
  // ID
  // ----------------------------------------------------------------------------------------------
  @PrimaryGeneratedColumn({ name: 'Id', type: 'int' })
  id: number;

  // ----------------------------------------------------------------------------------------------
  // NAME
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'nvarchar', length: 255, unique: true })
  product_name: string;

  // ----------------------------------------------------------------------------------------------
  // THUMBNAIL IMAGE
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'nvarchar', length: 500, nullable: true })
  thumbnail: string;

  // ----------------------------------------------------------------------------------------------
  // PRICE
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'decimal', precision: 18, scale: 2 })
  price: number;

  // ----------------------------------------------------------------------------------------------
  // DISCOUNT PRICE
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'decimal', precision: 18, scale: 2, default: 0 })
  discount: number;

  // ----------------------------------------------------------------------------------------------
  // STOCK QUANTITY
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'int', default: 0 })
  stock: number;

  // ----------------------------------------------------------------------------------------------
  // SKU
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'nvarchar', length: 100, nullable: true })
  sku: string;

  // ----------------------------------------------------------------------------------------------
  // BARCODE
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'nvarchar', length: 100, nullable: true })
  barcode: string;

  // ----------------------------------------------------------------------------------------------
  // STATUS
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'nvarchar', length: 50, default: 'Available' })
  status: string;

  // ----------------------------------------------------------------------------------------------
  // DESCRIPTION
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'nvarchar', length: 'MAX', nullable: true })
  description: string;

  // ----------------------------------------------------------------------------------------------
  // IS FEATURED
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'bit', default: false })
  isFeatured: boolean;

  // ----------------------------------------------------------------------------------------------
  // IS ACTIVE
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'bit', default: true })
  isActive: boolean;

  // ----------------------------------------------------------------------------------------------
  // CREATED AT
  // ----------------------------------------------------------------------------------------------
  @CreateDateColumn({ name: 'createdAt' })
  createdAt: Date;

  // ----------------------------------------------------------------------------------------------
  // UPDATED AT
  // ----------------------------------------------------------------------------------------------
  @UpdateDateColumn({ name: 'updatedAt', nullable: true })
  updatedAt: Date;

  // ----------------------------------------------------------------------------------------------
  // CREATED BY (UserId)
  // ----------------------------------------------------------------------------------------------
  @Column({ type: 'int', nullable: true })
  createdBy: number;

  // ----------------------------------------------------------------------------------------------
  // RELATIONS
  // ----------------------------------------------------------------------------------------------
  @ManyToOne(() => Category, (c) => c.products, { onDelete: 'SET NULL' })
  @JoinColumn({ name: "category_id" })
  category: Category;

  @ManyToOne(() => Brand, (b) => b.products, { onDelete: 'SET NULL' })
  @JoinColumn({ name: "brand_id" })
  brand: Brand;

  @OneToMany(() => ProductImage, (img) => img.product, { cascade: true })
  images: ProductImage[];
}
